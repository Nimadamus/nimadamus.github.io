<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BetLegend NHL Records</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<style>
  :root { --glow-color:#00e0ff; }
  body { margin:0; background:#000; color:#fff; font-family: 'Roboto', sans-serif; }
  .container { max-width:1140px; margin:40px auto; padding:0 16px; }
  .logo { text-align:center; font-family:'Orbitron', sans-serif; font-size:34px; color:var(--glow-color); letter-spacing:1px; margin-bottom:8px; }
  .card { background:#0a0f19; border-left:4px solid gold; border-radius:14px; padding:32px; box-shadow:0 15px 30px rgba(0,0,0,0.45); }
  .header { text-align:center; color:gold; font-size:26px; margin-bottom:6px; }
  .timestamp { text-align:center; color:#aaa; font-size:14px; margin-bottom:20px; }
  .nav-links { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px 30px; width: 100%; padding: 20px 0; margin-bottom: 30px; border-top: 1px solid rgba(0, 224, 255, 0.2); border-bottom: 1px solid rgba(0, 224, 255, 0.2); background: rgba(0,0,0,0.3); }
  .nav-links a, .dropdown .dropbtn { color: var(--glow-color); text-decoration: none; font-size: 16px; font-weight: bold; transition: text-shadow 0.3s ease, color 0.3s ease; background: none; border: none; font-family: 'Orbitron', sans-serif; cursor: pointer; padding: 5px 0; }
  .nav-links a:hover, .dropdown:hover .dropbtn { color: #fff; text-shadow: 0 0 10px var(--glow-color); }
  .dropdown { position: relative; display: inline-block; }
  .dropdown-content { display: none; position: absolute; background-color: rgba(0,0,0,0.9); backdrop-filter: blur(5px); min-width: 180px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 10; border: 1px solid rgba(0, 224, 255, 0.2); border-radius: 4px; padding: 10px 0; margin-top: 10px; }
  .dropdown-content a { color: var(--glow-color); padding: 12px 16px; text-decoration: none; display: block; font-size: 14px; text-align: left; }
  .dropdown-content a:hover { background-color: rgba(0, 224, 255, 0.1); color: #fff; }
  .dropdown:hover .dropdown-content { display: block; }
  .unit-scale-notice { text-align: center; background: rgba(0, 224, 255, 0.1); border: 1px solid rgba(0, 224, 255, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 25px; }
  .unit-scale-notice p { margin: 0; font-size: 14px; color: #fff; font-family: 'Roboto', sans-serif; line-height: 1.6; }

  .stats { display:grid; grid-template-columns: repeat(4, minmax(140px,1fr)); gap:14px; margin:10px 0 18px; }
  .stat { background:#0f1524; border:1px solid #1e2a44; border-radius:12px; padding:12px; text-align:center; }
  .stat .label { font-size:12px; color:#87a0c4; margin-bottom:4px; }
  .stat .value { font-size:20px; color:#fff; font-weight:700; }

  table { width:100%; border-collapse:collapse; margin-top:10px; }
  th, td { padding:12px 10px; border-bottom:1px solid #1b263b; font-size:14px; }
  th { color:gold; text-align:left; position:sticky; top:0; background:#0a0f19; }
  .note { color:#9fb3d1; font-size:13px; margin-top:12px; }
  a { color:var(--glow-color); text-decoration:none; }
  .result.win { color:#00ff66; font-weight:700; }
  .result.loss { color:#ff3333; font-weight:700; }
  .result.push { color:#87a0c4; font-weight:700; }
</style>
</head>
<body>
<div class="container">
  <div class="logo">BetLegend NHL</div>
  <div class="card">
    <div class="header">• NHL Records</div>
    <div class="timestamp">Updated: <span id="last-updated"></span></div>

    <nav class="nav-links" aria-label="Main Navigation">
    <a href="index.html" title="Home">Home</a>
    <a href="blog-page7.html">Picks &amp; Analysis</a>

    <div class="dropdown">
    <button class="dropbtn" aria-label="View Verified Records">Records</button>
    <div class="dropdown-content">
    <a href="betlegend-verified-records.html" title="MLB Betting Records">MLB Records</a>
    <a href="nfl-records.html" title="NFL Betting Records">NFL Records</a>
    <a href="ncaaf-records.html" title="College Football Betting Records">NCAAF Records</a>
    <a href="nhl-records.html" title="NHL Betting Records">NHL Records</a>
    <a href="nba-records.html" title="NBA Betting Records">NBA Records</a>
    </div>
    </div>

    <div class="dropdown">
    <button class="dropbtn" aria-label="Sports Categories">Sports</button>
    <div class="dropdown-content">
    <a href="nfl.html" title="Free NFL Picks and Predictions">NFL</a>
    <a href="mlb-page2.html" title="MLB Picks and Analysis">MLB</a>
    <a href="ncaaf.html" title="College Football Picks">NCAAF</a>
    <a href="nba.html" title="NBA Picks and Analysis">NBA</a>
    <a href="nhl.html" title="NHL Picks and Analysis">NHL</a>
    </div>
    </div>

    <div class="dropdown">
    <button class="dropbtn" aria-label="Betting Resources">Resources</button>
    <div class="dropdown-content">
    <a href="howitworks.html" title="How Our Picks Work">How It Works</a>
    <a href="bankroll.html" title="Bankroll Management Guide">Bankroll</a>
    <a href="screenshots.html" title="Pick Verification Screenshots">Screenshots</a>
    <a href="bestonlinesportsbook.html" title="Best Online Sportsbooks">Best Sportsbook</a>
    <a href="betting-101.html" title="Betting 101 Education">Betting 101</a>
    </div>
    </div>

    <a href="news.html" title="Sports Betting News">News</a>
    <a href="featured-game-of-the-day.html" title="Today's Featured Game Pick">Game of the Day</a>

    <div class="dropdown">
    <button class="dropbtn" aria-label="Join Community">Community</button>
    <div class="dropdown-content">
    <a href="https://twitter.com/BetLegend2025" target="_blank" rel="noopener" title="Follow on Twitter">Twitter</a>
    <a href="https://discord.gg/NbMc3wCV" target="_blank" rel="noopener" title="Join Discord Community">Discord</a>
    </div>
    </div>
    </nav>

    <div class="unit-scale-notice">
    <p><strong>All plays are between half a unit and 3 units on a 1 to 6 scale.</strong> 6 being the highest confidence (3 units), 1 being the lowest confidence (half a unit).</p>
    </div>

    <div class="stats">
      <div class="stat"><div class="label">Record</div><div class="value" id="stat-record">—</div></div>
      <div class="stat"><div class="label">Total Units</div><div class="value" id="stat-units">—</div></div>
      <div class="stat"><div class="label">Win %</div><div class="value" id="stat-winpct">—</div></div>
      <div class="stat"><div class="label">ROI</div><div class="value" id="stat-roi">—</div></div>
    </div>
    <table id="records-table" aria-label="NHL verified records table">
      <thead>
        <tr>
          <th style="width:110px;">Date</th>
          <th>Pick</th>
          <th style="width:80px;">Odds</th>
          <th style="width:80px;">Result</th>
          <th style="width:80px;">Units</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="note">
      Note: Stats reflect rows labeled Win/Loss/Push. Pending rows are ignored in percentages and ROI. ROI is computed as profit / total risk inferred from Odds and Units (no extra sheet columns needed). For Wins, Units is treated as to-win; for Losses we infer whether Units is risk or to-win.
    </div>
  </div>
</div>

<script>
const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRaRwsGOmbXrqAX0xqrDc9XwRCSaAOkuW68TArz3XQp7SMmLirKbdYqU5-zSM_A-MDNKG6sbdwZac6I/pub?output=csv'; // Live NHL CSV
const DATE_FMT = new Intl.DateTimeFormat('en-US', { month:'short', day:'2-digit', year:'numeric' });

function normalizeResult(val) {
  if(!val) return '';
  const s = String(val).trim().toLowerCase();
  if (s in {'w':1,'win':1,'won':1}) return 'Win';
  if (s in {'l':1,'loss':1,'lost':1}) return 'Loss';
  if (s in {'p':1,'push':1,'tie':1}) return 'Push';
  if (s in {'pending':1,'open':1}) return 'Pending';
  return val;
}

function parseUnits(v) {
  const n = parseFloat(String(v).replace(/[^0-9+\-\.]/g,'')); 
  return isFinite(n) ? n : 0;
}

function computeStats(rows) {
  // Compute ROI as profit / total risk inferred from Odds & Units; no extra sheet columns required.
  function parseOdds(v) {
    const n = parseFloat(String(v).replace(/[^0-9+\-\.]/g,''));
    return isFinite(n) ? n : NaN;
  }
  function riskToWin(toWin, odds) {
    if (!isFinite(odds)) return 0;
    if (odds < 0) return toWin * (Math.abs(odds) / 100);
    return toWin * (100 / odds);
  }
  function approxEqual(a,b,tol=0.02) { return Math.abs(a-b) <= tol; }

  let w=0, l=0, p=0, profit=0, totalRisk=0;
  rows.forEach(r => {
    const res = normalizeResult(r.Result);
    const odds = parseOdds(r.Odds);
    const units = parseUnits(r.Units);
    if (res === 'Win') {
      const won = Math.abs(units);           // Units recorded as amount won
      const risk = riskToWin(won, odds);     // Risk needed to win that amount
      w++;
      profit += won;
      totalRisk += risk;
    } else if (res === 'Loss') {
      const lossAbs = Math.abs(units);
      // If sheet stored to-win on loss, infer risk; otherwise treat as risk lost
      const inferredRisk = riskToWin(lossAbs, odds);
      const risk = approxEqual(lossAbs, inferredRisk) ? inferredRisk : lossAbs;
      l++;
      profit -= risk;
      totalRisk += risk;
    } else if (res === 'Push') {
      p++;
    }
  });
  const graded = w + l;
  const winPct = graded ? (w / graded) * 100 : 0;
  const roi = totalRisk ? (profit / totalRisk) * 100 : 0;
  return { w, l, p, totalUnits: profit, winPct, roi };
}

function render(rows) {
  document.getElementById('last-updated').textContent = new Date().toLocaleString();
  const tb = document.querySelector('#records-table tbody');
  tb.innerHTML = '';
  rows.forEach(r => {
    const tr = document.createElement('tr');
    const dateStr = r.Date ? r.Date : '';
    tr.innerHTML = `
      <td>${dateStr}</td>
      <td>${r.Pick || ''}</td>
      <td>${r.Odds || ''}</td>
      <td class="result ${normalizeResult(r.Result).toLowerCase()}">${normalizeResult(r.Result)}</td>
      <td>${r.Units || ''}</td>
    `;
    tb.appendChild(tr);
  });
  const st = computeStats(rows);
  document.getElementById('stat-record').textContent = `${st.w}-${st.l}-${st.p}`;
  document.getElementById('stat-units').textContent = (st.totalUnits >= 0 ? '+' : '') + (st.totalUnits).toFixed(2);
  document.getElementById('stat-winpct').textContent = (st.winPct).toFixed(1) + '%';
  document.getElementById('stat-roi').textContent = (st.roi >= 0 ? '+' : '') + (st.roi).toFixed(2) + '%';
}

fetch(CSV_URL)
  .then(r => r.text())
  .then(csv => {
    const parsed = Papa.parse(csv, { header:true, skipEmptyLines:true, transformHeader: h => h.trim() });
    const rows = parsed.data.filter(r => r.Pick && String(r.Pick).trim() !== '');
    render(rows);
  })
  .catch(err => {
    console.error('CSV load error', err);
    render([]);
  });
</script>

</body>
</html>
