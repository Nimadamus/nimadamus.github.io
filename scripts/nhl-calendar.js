// NHL Archive Calendar Data
// Last updated: February 24, 2026
// Auto-generated by sync_calendars.py - DO NOT EDIT MANUALLY

const ARCHIVE_DATA = [
    { date: "2026-02-25", page: "nhl.html", title: "NHL Game Previews Analysis Wednesday February 25 2026" },
    { date: "2026-02-25", page: "nhl-game-previews-analysis-february-25-2026.html", title: "NHL Game Previews Analysis Wednesday February 25 2026" },
    { date: "2026-02-05", page: "nhl-predictions-best-bets-tonight-february-05-2026.html", title: "NHL Analysis - February 5, 2026" },
    { date: "2026-02-04", page: "nhl-predictions-best-bets-tonight-february-04-2026.html", title: "NHL Analysis - February 4, 2026" },
    { date: "2026-02-03", page: "nhl-predictions-best-bets-tonight-february-03-2026.html", title: "NHL Analysis - February 3, 2026" },
    { date: "2026-02-02", page: "nhl-predictions-best-bets-tonight-february-02-2026.html", title: "NHL Analysis - February 2, 2026" },
    { date: "2026-02-01", page: "nhl-predictions-best-bets-tonight-february-01-2026.html", title: "NHL Analysis - February 1, 2026" },
    { date: "2026-01-30", page: "nhl-predictions-best-bets-tonight-january-30-2026.html", title: "NHL Analysis - January 30, 2026" },
    { date: "2026-01-29", page: "nhl-predictions-best-bets-tonight-january-29-2026.html", title: "NHL Analysis - January 29, 2026" },
    { date: "2026-01-28", page: "nhl-predictions-best-bets-tonight-january-28-2026.html", title: "NHL Analysis - January 28, 2026" },
    { date: "2026-01-24", page: "nhl-predictions-best-bets-tonight-january-24-2026.html", title: "NHL Analysis - January 24, 2026" },
    { date: "2026-01-23", page: "nhl-predictions-best-bets-tonight-january-23-2026.html", title: "NHL Analysis - January 23, 2026" },
    { date: "2026-01-22", page: "nhl-predictions-best-bets-tonight-january-22-2026.html", title: "NHL Analysis - January 22, 2026" },
    { date: "2026-01-21", page: "nhl-predictions-best-bets-tonight-january-21-2026.html", title: "NHL Analysis - January 21, 2026" },
    { date: "2026-01-20", page: "nhl-predictions-best-bets-tonight-january-20-2026.html", title: "NHL Analysis - January 20, 2026" },
    { date: "2026-01-19", page: "nhl-predictions-best-bets-tonight-january-19-2026.html", title: "NHL Analysis - January 19, 2026" },
    { date: "2026-01-18", page: "nhl-predictions-best-bets-tonight-january-18-2026.html", title: "NHL Analysis - January 18, 2026" },
    { date: "2026-01-18", page: "nhl-predictions-best-bets-tonight-january-18-2026-part-2.html", title: "NHL Analysis - January 18, 2026" },
    { date: "2026-01-17", page: "nhl-predictions-best-bets-tonight-january-17-2026.html", title: "NHL Analysis - January 17, 2026" },
    { date: "2026-01-17", page: "nhl-predictions-best-bets-tonight-january-17-2026-part-2.html", title: "NHL Analysis - January 17, 2026" },
    { date: "2026-01-16", page: "nhl-predictions-best-bets-tonight-january-16-2026.html", title: "NHL Analysis - January 16, 2026" },
    { date: "2026-01-15", page: "nhl-predictions-best-bets-tonight-january-15-2026.html", title: "NHL Analysis - January 15, 2026" },
    { date: "2026-01-14", page: "nhl-predictions-best-bets-tonight-january-14-2026.html", title: "NHL Analysis - January 14, 2026" },
    { date: "2026-01-13", page: "nhl-predictions-best-bets-tonight-january-13-2026.html", title: "NHL Analysis - January 13, 2026" },
    { date: "2026-01-12", page: "nhl-predictions-best-bets-tonight-january-12-2026.html", title: "NHL Analysis - January 12, 2026" },
    { date: "2026-01-11", page: "nhl-predictions-best-bets-tonight-january-11-2026.html", title: "NHL Analysis - January 11, 2026" },
    { date: "2026-01-11", page: "nhl-predictions-best-bets-tonight-january-11-2026-part-2.html", title: "NHL Analysis - January 11, 2026" },
    { date: "2026-01-10", page: "nhl-predictions-best-bets-tonight-january-10-2026.html", title: "NHL Analysis - January 10, 2026" },
    { date: "2026-01-09", page: "nhl-predictions-best-bets-tonight-january-09-2026.html", title: "NHL Analysis - January 09, 2026" },
    { date: "2026-01-08", page: "nhl-predictions-best-bets-tonight-january-08-2026.html", title: "NHL Analysis - January 08, 2026" },
    { date: "2026-01-07", page: "nhl-predictions-best-bets-tonight-january-07-2026.html", title: "NHL Analysis - January 07, 2026" },
    { date: "2026-01-06", page: "nhl-predictions-best-bets-tonight-january-06-2026.html", title: "NHL Analysis - January 06, 2026" },
    { date: "2026-01-05", page: "nhl-predictions-best-bets-tonight-january-05-2026.html", title: "NHL Analysis - January 05, 2026" },
    { date: "2026-01-04", page: "nhl-predictions-best-bets-tonight-january-04-2026.html", title: "NHL Analysis - January 04, 2026" },
    { date: "2026-01-03", page: "nhl-predictions-best-bets-tonight-january-03-2026.html", title: "NHL Analysis - January 3, 2026" },
    { date: "2026-01-03", page: "nhl-predictions-best-bets-tonight-january-03-2026-part-2.html", title: "NHL Analysis - January 03, 2026" },
    { date: "2026-01-02", page: "archives/nhl/2026-01-02.html", title: "NHL Archive - 2026-01-02" },
    { date: "2026-01-01", page: "nhl-predictions-best-bets-tonight-january-01-2026.html", title: "NHL Analysis - January 1, 2026" },
    { date: "2026-01-01", page: "nhl-predictions-best-bets-tonight-january-01-2026-part-3.html", title: "NHL Analysis - January 01, 2026" },
    { date: "2026-01-01", page: "nhl-predictions-best-bets-tonight-january-01-2026-part-2.html", title: "NHL Analysis - January 01, 2026" },
    { date: "2025-12-31", page: "nhl-predictions-best-bets-tonight-december-31-2025.html", title: "NHL Analysis - December 31, 2025" },
    { date: "2025-12-31", page: "nhl-predictions-best-bets-tonight-december-31-2025-part-2.html", title: "NHL Analysis - December 31, 2025" },
    { date: "2025-12-29", page: "nhl-predictions-best-bets-tonight-december-29-2025.html", title: "NHL Analysis - December 29, 2025" },
    { date: "2025-12-28", page: "nhl-predictions-best-bets-tonight-december-28-2025.html", title: "NHL Analysis - December 28, 2025" },
    { date: "2025-12-28", page: "nhl-predictions-best-bets-tonight-december-28-2025-part-2.html", title: "NHL Analysis - December 28, 2025 Part 2" },
    { date: "2025-12-27", page: "nhl-predictions-best-bets-tonight-december-27-2025.html", title: "NHL Analysis - December 27, 2025" },
    { date: "2025-12-27", page: "nhl-predictions-best-bets-tonight-december-27-2025-part-2.html", title: "NHL Analysis - December 27, 2025 Part 2" },
    { date: "2025-12-23", page: "nhl-predictions-best-bets-tonight-december-23-2025.html", title: "NHL Analysis - December 23, 2025" },
    { date: "2025-12-23", page: "nhl-predictions-best-bets-tonight-december-23-2025-part-2.html", title: "NHL Analysis - December 23, 2025" },
    { date: "2025-12-22", page: "nhl-predictions-best-bets-tonight-december-22-2025.html", title: "NHL Analysis - December 22, 2025" },
    { date: "2025-12-21", page: "nhl-predictions-best-bets-tonight-december-21-2025.html", title: "NHL Analysis - December 21, 2025" },
    { date: "2025-12-20", page: "nhl-predictions-best-bets-tonight-december-20-2025.html", title: "NHL Analysis - December 20, 2025" },
    { date: "2025-12-20", page: "nhl-predictions-best-bets-tonight-december-20-2025-part-3.html", title: "NHL Analysis - December 20, 2025" },
    { date: "2025-12-20", page: "nhl-predictions-best-bets-tonight-december-20-2025-part-2.html", title: "NHL Analysis - December 20, 2025" },
    { date: "2025-12-19", page: "nhl-predictions-best-bets-tonight-december-19-2025.html", title: "NHL Analysis - December 19, 2025" },
    { date: "2025-12-19", page: "nhl-predictions-best-bets-tonight-december-19-2025-part-2.html", title: "NHL Analysis - December 19, 2025" },
    { date: "2025-12-19", page: "nhl-dec19.html", title: "NHL Results - December 19, 2025" },
    { date: "2025-12-18", page: "nhl-predictions-best-bets-tonight-december-18-2025.html", title: "NHL Analysis - December 18, 2025" },
    { date: "2025-12-18", page: "nhl-predictions-best-bets-tonight-december-18-2025-part-3.html", title: "NHL Analysis - December 18, 2025" },
    { date: "2025-12-18", page: "nhl-predictions-best-bets-tonight-december-18-2025-part-2.html", title: "NHL December 18, 2025 - 8-Game Slate" },
    { date: "2025-12-17", page: "nhl-predictions-best-bets-tonight-december-17-2025.html", title: "NHL Analysis - December 17, 2025" },
    { date: "2025-12-17", page: "nhl-predictions-best-bets-tonight-december-17-2025-part-3.html", title: "NHL Analysis - December 17, 2025" },
    { date: "2025-12-17", page: "nhl-predictions-best-bets-tonight-december-17-2025-part-2.html", title: "NHL December 17, 2025 - 4-Game Slate" },
    { date: "2025-12-16", page: "nhl-predictions-best-bets-tonight-december-16-2025.html", title: "NHL Analysis - December 16, 2025" },
    { date: "2025-12-15", page: "nhl-predictions-best-bets-tonight-december-15-2025.html", title: "NHL Analysis - December 15, 2025" },
    { date: "2025-12-13", page: "nhl-predictions-best-bets-tonight-december-13-2025.html", title: "NHL December 13, 2025" },
    { date: "2025-12-12", page: "nhl-predictions-best-bets-tonight-december-12-2025.html", title: "NHL December 12, 2025" },
    { date: "2025-12-11", page: "nhl-predictions-best-bets-tonight-december-11-2025.html", title: "NHL December 11, 2025" },
    { date: "2025-12-10", page: "nhl-predictions-best-bets-tonight-december-10-2025.html", title: "NHL December 10, 2025" },
    { date: "2025-12-09", page: "nhl-predictions-best-bets-tonight-december-09-2025.html", title: "NHL Analysis - December 09, 2025" },
    { date: "2025-12-01", page: "archives/nhl/2025-12-01.html", title: "NHL Archive - 2025-12-01" },
    { date: "2025-11-30", page: "archives/nhl/2025-11-30.html", title: "NHL Archive - 2025-11-30" },
    { date: "2025-11-29", page: "archives/nhl/2025-11-29.html", title: "NHL Archive - 2025-11-29" },
    { date: "2025-11-24", page: "nhl-predictions-best-bets-tonight-november-24-2025.html", title: "NHL November 24, 2025 - 7-Game Slate" },
];

const dateMap = {};
ARCHIVE_DATA.forEach(item => { if (!dateMap[item.date]) dateMap[item.date] = item; });

const pageToDateMap = {};
ARCHIVE_DATA.forEach(item => { pageToDateMap[item.page] = item.date; });

// FIXED Jan 21, 2026: Main pages ALWAYS show today's date, archive pages show their date
const MAIN_PAGES = ['nba.html', 'nhl.html', 'ncaab.html', 'ncaaf.html', 'nfl.html', 'mlb.html', 'soccer.html'];
const today = new Date();
const todayStr = today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0') + '-' + String(today.getDate()).padStart(2, '0');

// Handle both root pages and archive pages
const pathname = window.location.pathname;
let currentPage;
if (pathname.includes('/archives/')) {
    // For archive pages, get the full relative path from archives/
    currentPage = pathname.replace(/^\//, '');
} else {
    // For root pages, just get the filename
    currentPage = pathname.split('/').pop() || 'index.html';
}

// For main pages (nba.html, nhl.html, etc), ALWAYS use today's date
// For archive pages (nba-picks-analysis-against-the-spread-january-21-2026.html), use the page's date
const isMainPage = MAIN_PAGES.includes(currentPage);
const forcedDate = window.FORCED_PAGE_DATE || null;
const currentPageDate = isMainPage ? (forcedDate || todayStr) : (pageToDateMap[currentPage] || null);

const months = new Set();
ARCHIVE_DATA.forEach(item => { const [y, m] = item.date.split('-'); months.add(y + '-' + m); });

// UPDATED Jan 21, 2026: Main pages show today's month, archive pages show their month
const sortedMonths = Array.from(months).sort().reverse();
const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

// For main pages, default to today's month; for archive pages, use their month
let displayMonth = currentPageDate ? currentPageDate.substring(0, 7) : sortedMonths[0];

function renderCalendar(yearMonth) {
    const [year, month] = yearMonth.split('-').map(Number);
    const yearEl = document.getElementById('cal-year');
    if (yearEl) yearEl.textContent = year;
    const firstDay = new Date(year, month - 1, 1).getDay();
    const daysInMonth = new Date(year, month, 0).getDate();
    const container = document.getElementById('calendar-days');
    if (!container) return;
    container.innerHTML = '';
    for (let i = 0; i < firstDay; i++) { const cell = document.createElement('div'); cell.className = 'cal-day empty'; container.appendChild(cell); }
    for (let d = 1; d <= daysInMonth; d++) {
        const dateStr = year + '-' + String(month).padStart(2, '0') + '-' + String(d).padStart(2, '0');
        const hasData = dateMap[dateStr];
        let classes = 'cal-day';
        if (dateStr === currentPageDate) classes += ' current-page';
        // Removed 'today' highlight - calendar shows PAGE date, not actual date
        if (hasData) classes += ' has-content';
        const cell = document.createElement('div');
        cell.className = classes;
        cell.textContent = d;
        if (hasData) { cell.title = hasData.title; cell.onclick = () => window.location.href = "/" + hasData.page; }
        container.appendChild(cell);
    }
}

function initSportCalendar() {
    const monthSelect = document.getElementById('month-select');
    if (monthSelect) {
        monthSelect.innerHTML = '';
        sortedMonths.forEach(m => {
            const [year, month] = m.split('-');
            const opt = document.createElement('option');
            opt.value = m;
            opt.textContent = monthNames[parseInt(month) - 1] + ' ' + year;
            if (m === displayMonth) opt.selected = true;
            monthSelect.appendChild(opt);
        });
        monthSelect.addEventListener('change', function() { renderCalendar(this.value); });
    }
    renderCalendar(displayMonth);
    const mobileSelect = document.getElementById('mobile-archive-select');
    if (mobileSelect) {
        mobileSelect.innerHTML = '<option value="">Select a date...</option>';
        ARCHIVE_DATA.forEach(item => {
            const opt = document.createElement('option');
            opt.value = item.page;
            const dateObj = new Date(item.date + 'T12:00:00');
            const dateLabel = dateObj.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
            opt.textContent = dateLabel + ' - ' + item.title;
            if (item.page === currentPage) opt.selected = true;
            mobileSelect.appendChild(opt);
        });
        mobileSelect.addEventListener('change', (e) => { if (e.target.value) window.location.href = '/' + e.target.value; });
    }
}

if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', initSportCalendar); } else { initSportCalendar(); }
