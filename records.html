<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>BetLegend Complete Performance Records & Analytics Dashboard</title>
<meta content="Complete auto-updating betting performance analytics: ROI, units won, win percentage breakdown by sport, bet type, month, and confidence level. Live verified records dashboard." name="description"/>
<meta content="betting records, ROI tracker, sports betting analytics, unit tracking, win percentage, verified picks, bet type breakdown" name="keywords"/>
<link href="https://www.betlegendpicks.com/newlogo.png" rel="icon" type="image/png"/>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"/>
<link rel="canonical" href="https://www.betlegendpicks.com/records.html">
<meta property="og:title" content="BetLegend Performance Records Dashboard">
<meta property="og:description" content="Live betting analytics with complete breakdowns by sport, bet type, month, and confidence level">
<meta property="og:url" content="https://www.betlegendpicks.com/records.html">
<meta property="og:type" content="website">
<meta property="og:image" content="https://www.betlegendpicks.com/newlogo.png">
<style>
:root {
    --primary: #0a0a0a;
    --secondary: #1a1a1a;
    --accent: #00e0ff;
    --gold: #FFD700;
    --green: #39FF14;
    --red: #FF3131;
    --text: #ffffff;
    --muted: #888;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
    font-family: 'Roboto', sans-serif;
    color: var(--text);
    line-height: 1.6;
    min-height: 100vh;
}

.header {
    background: linear-gradient(135deg, rgba(0, 224, 255, 0.1) 0%, rgba(255, 215, 0, 0.1) 100%);
    border-bottom: 2px solid var(--accent);
    padding: 40px 20px;
    text-align: center;
}

.header h1 {
    font-family: 'Orbitron', sans-serif;
    font-size: 72px;
    font-weight: 900;
    color: var(--accent);
    text-shadow: 0 0 30px var(--accent);
    margin-bottom: 10px;
    letter-spacing: 2px;
}

.header .tagline {
    font-size: 18px;
    color: var(--gold);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 3px;
}

.loading {
    text-align: center;
    padding: 100px 20px;
    font-size: 24px;
    color: var(--accent);
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 40px 20px;
}

.summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 25px;
    margin-bottom: 50px;
}

.stat-card {
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(20, 20, 40, 0.95) 100%);
    border: 2px solid var(--accent);
    border-radius: 15px;
    padding: 30px;
    text-align: center;
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 40px rgba(0, 224, 255, 0.3);
    border-color: var(--gold);
}

.stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 5px;
    background: linear-gradient(90deg, var(--accent), var(--gold));
}

.stat-label {
    font-size: 14px;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 10px;
    font-weight: 500;
}

.stat-value {
    font-family: 'Orbitron', sans-serif;
    font-size: 62px;
    font-weight: 900;
    color: var(--accent);
    text-shadow: 0 0 20px var(--accent);
    line-height: 1;
}

.stat-value.positive {
    color: var(--green);
    text-shadow: 0 0 20px var(--green);
}

.stat-value.negative {
    color: var(--red);
    text-shadow: 0 0 20px var(--red);
}

.section {
    background: rgba(26, 26, 26, 0.6);
    border: 1px solid rgba(0, 224, 255, 0.3);
    border-radius: 15px;
    padding: 40px;
    margin-bottom: 40px;
    backdrop-filter: blur(10px);
}

.section-title {
    font-family: 'Orbitron', sans-serif;
    font-size: 48px;
    font-weight: 700;
    color: var(--gold);
    margin-bottom: 30px;
    text-transform: uppercase;
    letter-spacing: 2px;
    display: flex;
    align-items: center;
    gap: 15px;
}

.section-title::before {
    content: '';
    width: 50px;
    height: 4px;
    background: linear-gradient(90deg, var(--accent), var(--gold));
    border-radius: 2px;
}

.table-container {
    overflow-x: auto;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

thead {
    background: linear-gradient(135deg, rgba(0, 224, 255, 0.2) 0%, rgba(255, 215, 0, 0.2) 100%);
}

th {
    font-family: 'Orbitron', sans-serif;
    padding: 22px 20px;
    text-align: left;
    font-weight: 700;
    color: var(--accent);
    text-transform: uppercase;
    font-size: 18px;
    letter-spacing: 1px;
    border-bottom: 2px solid var(--accent);
}

td {
    padding: 22px 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    font-size: 20px;
}

tbody tr {
    transition: all 0.2s ease;
}

tbody tr:hover {
    background: rgba(0, 224, 255, 0.05);
}

.win {
    color: var(--green);
    font-weight: 700;
}

.loss {
    color: var(--red);
    font-weight: 700;
}

.badge {
    display: inline-block;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.badge-nfl { background: rgba(255, 49, 49, 0.2); color: #FF3131; border: 1px solid #FF3131; }
.badge-nba { background: rgba(0, 224, 255, 0.2); color: var(--accent); border: 1px solid var(--accent); }
.badge-nhl { background: rgba(255, 215, 0, 0.2); color: var(--gold); border: 1px solid var(--gold); }
.badge-mlb { background: rgba(57, 255, 20, 0.2); color: var(--green); border: 1px solid var(--green); }
.badge-ncaaf { background: rgba(255, 105, 180, 0.2); color: #FF69B4; border: 1px solid #FF69B4; }

.progress-bar {
    width: 100%;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    overflow: hidden;
    margin-top: 8px;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--green));
    border-radius: 10px;
    transition: width 0.5s ease;
}

.highlight-box {
    background: linear-gradient(135deg, rgba(57, 255, 20, 0.1) 0%, rgba(0, 224, 255, 0.1) 100%);
    border-left: 5px solid var(--green);
    padding: 25px;
    border-radius: 10px;
    margin: 30px 0;
}

.highlight-box h3 {
    font-family: 'Orbitron', sans-serif;
    color: var(--green);
    margin-bottom: 15px;
    font-size: 22px;
}

.footer-note {
    text-align: center;
    margin-top: 60px;
    padding: 30px;
    background: rgba(0, 224, 255, 0.05);
    border-radius: 10px;
    border: 1px solid rgba(0, 224, 255, 0.2);
    color: var(--muted);
    font-size: 14px;
}

.last-updated {
    text-align: center;
    font-size: 14px;
    color: var(--muted);
    margin-top: 20px;
    font-style: italic;
}

@media (max-width: 768px) {
    .header h1 {
        font-size: 32px;
    }

    .summary-grid {
        grid-template-columns: 1fr;
    }

    .section {
        padding: 25px;
    }

    .stat-value {
        font-size: 32px;
    }
}
</style>
</head>
<body>

<div class="header">
    <h1>üèÜ COMPLETE PERFORMANCE DASHBOARD</h1>
    <p class="tagline">Live-Updating Verified Records & Analytics</p>
</div>

<div id="loading-screen" class="loading">
    <p>üìä Loading all records from verified sources...</p>
    <p style="font-size: 16px; margin-top: 20px;">Aggregating NFL, NBA, NHL, MLB, NCAAF, and Soccer data...</p>
</div>

<div class="container" id="main-content" style="display: none;">

    <!-- Overall Summary Cards -->
    <div class="summary-grid">
        <div class="stat-card">
            <div class="stat-label">Total Record</div>
            <div class="stat-value" id="total-record">--</div>
            <div class="progress-bar">
                <div class="progress-fill" id="win-progress" style="width: 0%;"></div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-label">Win Rate</div>
            <div class="stat-value" id="win-rate">--</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">Total Units</div>
            <div class="stat-value" id="total-units">--</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">ROI</div>
            <div class="stat-value" id="total-roi">--</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">Avg Odds</div>
            <div class="stat-value" id="avg-odds">--</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">Total Picks</div>
            <div class="stat-value" id="total-picks">--</div>
        </div>
    </div>

    <!-- Sport Breakdown -->
    <div class="section">
        <h2 class="section-title">üìä Breakdown by Sport</h2>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Sport</th>
                        <th>Record</th>
                        <th>Win %</th>
                        <th>Units</th>
                        <th>ROI</th>
                        <th>Avg Odds</th>
                    </tr>
                </thead>
                <tbody id="sport-breakdown"></tbody>
            </table>
        </div>
    </div>

    <!-- Bet Type Breakdown -->
    <div class="section">
        <h2 class="section-title">üéØ Breakdown by Bet Type</h2>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Bet Type</th>
                        <th>Record</th>
                        <th>Win %</th>
                        <th>Units</th>
                        <th>ROI</th>
                        <th>Best Sport</th>
                    </tr>
                </thead>
                <tbody id="bet-type-breakdown"></tbody>
            </table>
        </div>
    </div>

    <!-- Monthly Performance -->
    <div class="section">
        <h2 class="section-title">üìÖ Monthly Performance</h2>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Record</th>
                        <th>Win %</th>
                        <th>Units</th>
                        <th>ROI</th>
                        <th>Best Sport</th>
                    </tr>
                </thead>
                <tbody id="monthly-breakdown"></tbody>
            </table>
        </div>
    </div>

    <!-- Unit Sizing Breakdown -->
    <div class="section">
        <h2 class="section-title">üí∞ Unit Sizing & Confidence Levels</h2>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Confidence</th>
                        <th>Unit Size</th>
                        <th>Record</th>
                        <th>Win %</th>
                        <th>Total Units</th>
                        <th>ROI</th>
                    </tr>
                </thead>
                <tbody id="unit-sizing-breakdown"></tbody>
            </table>
        </div>

        <div class="highlight-box">
            <h3>üí° Bankroll Strategy</h3>
            <p>We use a <strong>flat unit betting system</strong> with scaled confidence sizing (0.5u to 3u). All records are auto-calculated from verified Google Sheets data.</p>
        </div>
    </div>

    <!-- Methodology -->
    <div class="section">
        <h2 class="section-title">üß† Methodology & Data Source</h2>
        <div class="highlight-box" style="border-left-color: var(--accent);">
            <h3>How This Dashboard Works</h3>
            <ul style="margin-left: 20px; line-height: 2; margin-top: 15px;">
                <li><strong>Auto-updating:</strong> All data pulled live from verified Google Sheets</li>
                <li><strong>Complete transparency:</strong> Every pick tracked with date, result, and units</li>
                <li><strong>Calculated metrics:</strong> Win %, ROI, and breakdowns generated automatically</li>
                <li><strong>No manual editing:</strong> Numbers can't be fudged - direct from source</li>
            </ul>
        </div>
    </div>

    <div class="footer-note">
        <p><strong>üì¢ Records Disclaimer:</strong> Past performance does not guarantee future results. All data auto-generated from verified Google Sheets. Last refreshed on page load.</p>
        <p class="last-updated" id="last-updated">üïí Page loaded: <span id="load-time"></span></p>
        <p style="margin-top: 20px;">
            <a href="index.html" style="color: var(--accent); text-decoration: none; font-weight: 700;">‚Üê Back to Home</a> |
            <a href="upcomingpicks.html" style="color: var(--accent); text-decoration: none; font-weight: 700; margin-left: 20px;">View Upcoming Picks ‚Üí</a>
        </p>
    </div>

</div>

<script>
// Google Sheets CSV URLs for each sport
const SHEET_URLS = {
    'NFL': 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQgB4WcyyEpMBp_XI_ya6hC7Y8kRaHzrOvuLMq9voGF0nzfqi4lkmAWVb92nDkxUhLVhzr4RTWtZRxq/pub?output=csv',
    'NBA': 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSBoPl-dhj7ZAVpRIafqrFBf10r6sg3jpEKxmuymugAckdoMp-czkj1hscpDnV42GGJsIvNx5EniLVz/pub?output=csv',
    'NHL': 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRaRwsGOmbXrqAX0xqrDc9XwRCSaAOkuW68TArz3XQp7SMmLirKbdYqU5-zSM_A-MDNKG6sbdwZac6I/pub?output=csv',
    'MLB': 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQE9RjSNABgl0SxSA1ghp9soUs4gq7teoncN5GLmG5faXmH-sDwXgg0mrk0iQwmSEYExtx6xwFMflXv/pub?output=csv',
    'NCAAF': 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ9c45xiuXWNe-fAXYMoNb00kCBHfMf4Yn-Xr2LUqdCIiuoiXXDgrDa5mq1PZqxjg8hx-5KnS0L4uVU/pub?output=csv',
    'Soccer': 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQy0EQskvixsVQb1zzYtCKDa4F1Wl6WU5QuAFMit32vms-c4DxlhLik-k7U_EhuYntQrpw4BI6r0rns/pub?output=csv'
};

let allData = [];

async function fetchAllData() {
    const promises = Object.entries(SHEET_URLS).map(async ([sheetSport, url]) => {
        try {
            const response = await fetch(url);
            const csv = await response.text();
            const rows = parseCSV(csv);
            // Use the sport from the sheet name as fallback
            return rows.map(row => ({
                ...row,
                sport: sheetSport // This maps to the correct sheet
            }));
        } catch (error) {
            console.error(`Error fetching ${sheetSport} data:`, error);
            return [];
        }
    });

    const results = await Promise.all(promises);
    allData = results.flat();
    console.log(`Loaded ${allData.length} total picks across all sports`);
}

function parseCSV(csvText) {
    const lines = csvText.split('\n');
    const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
    const data = [];

    for (let i = 1; i < lines.length; i++) {
        if (lines[i].trim() === '') continue;

        const values = parseCSVLine(lines[i]);
        if (values.length >= headers.length) {
            const row = {};
            headers.forEach((header, index) => {
                row[header] = values[index] || '';
            });
            data.push(row);
        }
    }
    return data;
}

function parseCSVLine(line) {
    const result = [];
    let current = '';
    let inQuotes = false;

    for (let i = 0; i < line.length; i++) {
        const char = line[i];

        if (char === '"') {
            inQuotes = !inQuotes;
        } else if (char === ',' && !inQuotes) {
            result.push(current.trim());
            current = '';
        } else {
            current += char;
        }
    }
    result.push(current.trim());
    return result;
}

function calculateOverallStats() {
    let wins = 0, losses = 0, pushes = 0;
    let totalUnits = 0, totalRisk = 0;
    let totalOdds = 0, oddsCount = 0;

    allData.forEach(row => {
        const result = (row.Result || row.result || '').toLowerCase();
        const units = parseFloat(row.Units || row.units || 0);
        const line = row.Line || row.line || '';

        if (result.includes('win') || result.includes('w')) {
            wins++;
            totalUnits += Math.abs(units);
            totalRisk += Math.abs(units);
        } else if (result.includes('loss') || result.includes('l')) {
            losses++;
            totalUnits -= Math.abs(units);
            totalRisk += Math.abs(units);
        } else if (result.includes('push')) {
            pushes++;
        }

        const odds = extractOdds(line);
        if (odds) {
            totalOdds += odds;
            oddsCount++;
        }
    });

    const totalPicks = wins + losses + pushes;
    const winRate = totalPicks > 0 ? (wins / (wins + losses)) * 100 : 0;
    const roi = totalRisk > 0 ? (totalUnits / totalRisk) * 100 : 0;
    const avgOdds = oddsCount > 0 ? Math.round(totalOdds / oddsCount) : -110;

    document.getElementById('total-record').textContent = `${wins}-${losses}${pushes > 0 ? `-${pushes}` : ''}`;
    document.getElementById('win-rate').textContent = winRate.toFixed(1) + '%';
    document.getElementById('win-rate').className = `stat-value ${winRate > 50 ? 'positive' : 'negative'}`;
    document.getElementById('total-units').textContent = (totalUnits >= 0 ? '+' : '') + totalUnits.toFixed(1) + 'u';
    document.getElementById('total-units').className = `stat-value ${totalUnits >= 0 ? 'positive' : 'negative'}`;
    document.getElementById('total-roi').textContent = (roi >= 0 ? '+' : '') + roi.toFixed(1) + '%';
    document.getElementById('total-roi').className = `stat-value ${roi >= 0 ? 'positive' : 'negative'}`;
    document.getElementById('avg-odds').textContent = avgOdds > 0 ? '+' + avgOdds : avgOdds;
    document.getElementById('total-picks').textContent = totalPicks;
    document.getElementById('win-progress').style.width = winRate + '%';
}

function calculateSportBreakdown() {
    const sports = ['NFL', 'NBA', 'NHL', 'MLB', 'NCAAF', 'Soccer'];
    const tbody = document.getElementById('sport-breakdown');
    tbody.innerHTML = '';

    sports.forEach(sport => {
        const sportData = allData.filter(row => row.sport === sport);
        if (sportData.length === 0) return;

        const stats = calculateStats(sportData);
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><span class="badge badge-${sport.toLowerCase()}">${sport}</span></td>
            <td class="${stats.winRate > 50 ? 'win' : 'loss'}">${stats.record}</td>
            <td class="${stats.winRate > 50 ? 'win' : ''}">${stats.winRate.toFixed(1)}%</td>
            <td class="${stats.units >= 0 ? 'win' : 'loss'}">${stats.units >= 0 ? '+' : ''}${stats.units.toFixed(1)}u</td>
            <td class="${stats.roi >= 0 ? 'win' : 'loss'}">${stats.roi >= 0 ? '+' : ''}${stats.roi.toFixed(1)}%</td>
            <td>${stats.avgOdds > 0 ? '+' : ''}${stats.avgOdds}</td>
        `;
        tbody.appendChild(row);
    });
}

function calculateBetTypeBreakdown() {
    const betTypes = ['Spread', 'Moneyline', 'Total', 'Over', 'Under'];
    const tbody = document.getElementById('bet-type-breakdown');
    tbody.innerHTML = '';

    betTypes.forEach(betType => {
        const typeData = allData.filter(row => {
            const pick = (row.Pick || row.pick || '').toLowerCase();
            if (betType === 'Spread') return pick.includes('+') || pick.includes('-');
            if (betType === 'Moneyline') return pick.includes('ml') || (!pick.includes('over') && !pick.includes('under') && !pick.includes('+') && !pick.includes('-'));
            if (betType === 'Total' || betType === 'Over' || betType === 'Under') return pick.includes(betType.toLowerCase());
            return false;
        });

        if (typeData.length === 0) return;

        const stats = calculateStats(typeData);
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><strong>${betType}</strong></td>
            <td class="${stats.winRate > 50 ? 'win' : 'loss'}">${stats.record}</td>
            <td class="${stats.winRate > 50 ? 'win' : ''}">${stats.winRate.toFixed(1)}%</td>
            <td class="${stats.units >= 0 ? 'win' : 'loss'}">${stats.units >= 0 ? '+' : ''}${stats.units.toFixed(1)}u</td>
            <td class="${stats.roi >= 0 ? 'win' : 'loss'}">${stats.roi >= 0 ? '+' : ''}${stats.roi.toFixed(1)}%</td>
            <td>${findBestSport(typeData)}</td>
        `;
        tbody.appendChild(row);
    });
}

function calculateMonthlyBreakdown() {
    const monthlyData = {};

    allData.forEach(row => {
        const dateStr = row.Date || row.date || '';
        const date = new Date(dateStr);
        if (isNaN(date)) return;

        const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
        const monthName = date.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });

        if (!monthlyData[monthKey]) {
            monthlyData[monthKey] = { name: monthName, data: [] };
        }
        monthlyData[monthKey].data.push(row);
    });

    const tbody = document.getElementById('monthly-breakdown');
    tbody.innerHTML = '';

    Object.values(monthlyData).reverse().forEach(month => {
        const stats = calculateStats(month.data);
        const bestSport = findBestSport(month.data);

        const row = document.createElement('tr');
        row.innerHTML = `
            <td><strong>${month.name}</strong></td>
            <td class="${stats.winRate > 50 ? 'win' : 'loss'}">${stats.record}</td>
            <td class="${stats.winRate > 50 ? 'win' : ''}">${stats.winRate.toFixed(1)}%</td>
            <td class="${stats.units >= 0 ? 'win' : 'loss'}">${stats.units >= 0 ? '+' : ''}${stats.units.toFixed(1)}u</td>
            <td class="${stats.roi >= 0 ? 'win' : 'loss'}">${stats.roi >= 0 ? '+' : ''}${stats.roi.toFixed(1)}%</td>
            <td>${bestSport}</td>
        `;
        tbody.appendChild(row);
    });
}

function calculateUnitSizingBreakdown() {
    const confidenceLevels = [
        { name: 'üî• MAX PLAY (3u)', min: 2.5, max: 3 },
        { name: '‚≠ê HIGH (2u)', min: 1.5, max: 2.5 },
        { name: '‚úì STANDARD (1u)', min: 0.5, max: 1.5 },
        { name: 'üìâ SMALL (0.5u)', min: 0, max: 0.5 }
    ];

    const tbody = document.getElementById('unit-sizing-breakdown');
    tbody.innerHTML = '';

    confidenceLevels.forEach(level => {
        const levelData = allData.filter(row => {
            const units = Math.abs(parseFloat(row.Units || row.units || 0));
            return units > level.min && units <= level.max;
        });

        if (levelData.length === 0) return;

        const stats = calculateStats(levelData);
        const avgUnit = levelData.reduce((sum, row) => sum + Math.abs(parseFloat(row.Units || row.units || 0)), 0) / levelData.length;

        const row = document.createElement('tr');
        row.innerHTML = `
            <td><strong>${level.name}</strong></td>
            <td>${avgUnit.toFixed(1)}u</td>
            <td class="${stats.winRate > 50 ? 'win' : 'loss'}">${stats.record}</td>
            <td class="${stats.winRate > 50 ? 'win' : ''}">${stats.winRate.toFixed(1)}%</td>
            <td class="${stats.units >= 0 ? 'win' : 'loss'}">${stats.units >= 0 ? '+' : ''}${stats.units.toFixed(1)}u</td>
            <td class="${stats.roi >= 0 ? 'win' : 'loss'}">${stats.roi >= 0 ? '+' : ''}${stats.roi.toFixed(1)}%</td>
        `;
        tbody.appendChild(row);
    });
}

function calculateStats(data) {
    let wins = 0, losses = 0, pushes = 0;
    let totalUnits = 0, totalRisk = 0;
    let totalOdds = 0, oddsCount = 0;

    data.forEach(row => {
        const result = (row.Result || row.result || '').toLowerCase();
        const units = parseFloat(row.Units || row.units || 0);
        const line = row.Line || row.line || '';

        if (result.includes('win') || result.includes('w')) {
            wins++;
            totalUnits += Math.abs(units);
            totalRisk += Math.abs(units);
        } else if (result.includes('loss') || result.includes('l')) {
            losses++;
            totalUnits -= Math.abs(units);
            totalRisk += Math.abs(units);
        } else if (result.includes('push')) {
            pushes++;
        }

        const odds = extractOdds(line);
        if (odds) {
            totalOdds += odds;
            oddsCount++;
        }
    });

    const winRate = (wins + losses) > 0 ? (wins / (wins + losses)) * 100 : 0;
    const roi = totalRisk > 0 ? (totalUnits / totalRisk) * 100 : 0;
    const avgOdds = oddsCount > 0 ? Math.round(totalOdds / oddsCount) : -110;

    return {
        record: `${wins}-${losses}${pushes > 0 ? `-${pushes}` : ''}`,
        wins, losses, pushes,
        winRate,
        units: totalUnits,
        roi,
        avgOdds
    };
}

function findBestSport(data) {
    const sports = ['NFL', 'NBA', 'NHL', 'MLB', 'NCAAF', 'Soccer'];
    let bestSport = '';
    let bestWinRate = 0;

    sports.forEach(sport => {
        const sportData = data.filter(row => row.sport === sport);
        if (sportData.length === 0) return;

        const stats = calculateStats(sportData);
        if (stats.winRate > bestWinRate) {
            bestWinRate = stats.winRate;
            bestSport = `${sport} (${stats.winRate.toFixed(1)}%)`;
        }
    });

    return bestSport || 'N/A';
}

function extractOdds(line) {
    // Match all numbers with +/- signs, then take the last one (which is typically the odds)
    const matches = line.match(/([+-]\d+)/g);
    if (!matches || matches.length === 0) return null;

    // The odds are usually the last +/- number in the line
    const lastMatch = matches[matches.length - 1];
    return parseInt(lastMatch);
}

async function init() {
    try {
        await fetchAllData();

        calculateOverallStats();
        calculateSportBreakdown();
        calculateBetTypeBreakdown();
        calculateMonthlyBreakdown();
        calculateUnitSizingBreakdown();

        document.getElementById('loading-screen').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';

        const now = new Date();
        document.getElementById('load-time').textContent = now.toLocaleString();
    } catch (error) {
        console.error('Error initializing dashboard:', error);
        document.getElementById('loading-screen').innerHTML = '<p style="color: var(--red);">Error loading data. Please refresh the page.</p>';
    }
}

document.addEventListener('DOMContentLoaded', init);
</script>

</body>
</html>
